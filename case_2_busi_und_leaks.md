### 1. Бизнес-анализ (Business Understanding)

#### Организационная структура
- **Заказчик:** Газотранспортное или газодобывающее дочернее общество ПАО "Газпром" (эксплуатация линейной части магистральных газопроводов, компрессорных станций, газовых скважин).
- **Основной пользователь сервиса:** Операторы и инженерно-технический персонал по техническому обслуживанию, службы промышленной безопасности, аналитики ESG, корпоративная экологическая инспекция.
- **Коммуникация:**
  - на этапе MVP - взаимодействие с менторами курса осуществляется в Telegram-группе Практическая ML-инженерия: новости & обсуждения.
  - в перспективе - взаимодействие с функциональным заказчиком и структурными подразделениями эксплуатирующей организации - в соответствии с условиями договора. 

Создаются рабочие группы и чаты:
- Рабочая группа по сбору данных (инженеры, аналитики, представители эксплуатирующей организации)
- Группа ML-разработки (аналитики, разработчики)

#### Бизнес-цель
- Создание MVP, демонстрирующего потенциальному Заказчику (эксплуатирующей организации) возможность прогнозирования утечек метана на объектах газовой отрасли с использованием методов ML в целях заключения контракта по реальному объеку.

Преимущества для потенциального Заказчика (эксплуатирующей организации):
- Уменьшение числа аварийных утечек метана.
- Повышение эффективности планово-предупредительных ремонтов.
- Снижение объема выбросов метана.
- Повышение точности ESG-отчетности и снижение штрафных санкций.

#### Текущие решения
- Используются журналы фиксирования утечек метана (обход обвязки компрессорных станций и линейной части магистральных газопроводов сотрудниками научно-технических корпоративных центров не чаще 1 раза в 3 месяца)
- Функционирует система мониторинга без предиктивной аналитики.
- Риски утечек метана определяются по опыту или визуальному осмотру.
- Нет автоматических алертов (только датчики концентраций в закрытых помещениях в соответсвии с требованиями промышленной безопасности), аналитика данных - постфактум.

**Важно:** На текущий момент полноценного датасета, содержащего метки утечек метана, технические и метео параметры, не существует. Его сбор — отдельный проект с полевыми измерениями, интеграцией с SCADA и историей ТО.

**Для реализации MVP на первом этапе (в рамках 3 модуля курса Практическая ML-инженерия) будет использоваться синтетически сгенерированный датасет**, основанный на отраслевых знаниях, инженерной логике, модели компрессорной станции и имитации типовых сценариев утечек. Такая стратегия позволяет протестировать гипотезу, архитектуру модели и механику алертов. Структура датасета будет формироваться в том числе с учетом корпоративных форм измерений утечек метана, применяемых экслуатирующей организацией.

В качестве **репрезентативного пилотного объекта** на данном этапе будет выбрана **услованая компрессорная станция природного газа**, т.к. она содержит разнообразные элементы оборудования с риском утечек (фланцы, краны, задвижки, уплотнения и др.).

После подтверждения эффективности подхода и демонстрации результатов работы модели на синтетических данных, возможна подготовка коммерческого предложения для эксплуатирующей организации по **реализации проекта интеллектуального мониторинга утечек метана на репрезентативном объекте ПАО "Газпром", включая регулярные полевые измерения утечек метана для формирования уникального датасета, интеграции с телеметрией объекта и прогнозирования утечек метана на основе методов машинного обучения.**

### 1.1 Текущая ситуация

#### Ресурсы:
- На этапе разработки MVP потребностей в мощных вычислениях **нет** — модель (например, LightGBM) можно обучить на домашнем PC или стандартном сервере (8–16 ГБ RAM, 4–8 CPU).
- Данные синтетические, объем — до 20 тыс. строк.

**При переходе к реальным данным потребуется:**
- Подключение к SCADA и ИТ-инфраструктуре потенциального заказчика
- Организация защищенного хранилища для датасета
- Выделенные вычислительные ресурсы (сервер с GPU, 32+ ГБ RAM) — для работы с временными рядами и deep learning

#### Участие экспертов:
- На этапе синтетических данных — консультации по структуре узлов, параметрам и логике утечек метана с представителями эксплуатирующей организации, менторами курса Практическая ML-инженерия в части Data Project и ML.

#### Возможные риски:
- Перенос модели с синтетики на реальные данные может потребовать переобучения.
- Недостаточная детализация по типам оборудования.
- Ограниченный доступ к корпоративным информационным системам (SCADA/истории ТО).

#### План по снижению рисков:
- Пилот на 1 объекте (компрессорная станция)
- Итеративное уточнение синтетических данных
- Тестирование логики на инженерных кейсах

### 1.2 Задачи с точки зрения аналитики (Data Mining Goals)

#### Техническая цель
- Прогноз вероятности **возникновения утечки** на каждом узле оборудования в горизонте 7, 30 и 90 дней.
- Целевая переменная: произошла ли утечка в течение заданного окна после наблюдения.

**На синтетике:** метки добавляются искусственно с учетом вероятностных правил и шума.
**На реальном объекте:** метки формируются по актам, замерам, SCADA и записям об авариях.

#### Метрики:
- AUC-ROC — ключевая метрика (>=0.75 — минимум, >=0.80 — цель)
- Logloss — для оценки полезности алертов
- Валидация на выборке + инженерный анализ «релевантных» кейсов

#### Модели машинного обучения:

**Формат задачи:** отложенная бинарная классификация по времени.

**На синтетике:** используется библиотека градиентного бустинга LightGBM — простая, быстрая, хорошо интерпретируемая.
**На реальных данных:** возможен переход к гибридной архитектуре (требует отдельного анализа)

Интерпретируемость на этапе MVP важна для получения доверия пользователей и калибровки модели.

### 1.3 План проекта (Project Plan)

#### **Фаза 1. Business Understanding (1 неделя)**
- Формулировка бизнес-проблемы: прогноз утечек метана.
- Согласование целей и формата MVP.
- Определение ключевых пользователей и архитектуры будущего сервиса.
- Идентификация пилотного объекта (условная компрессорная станция).

**Результат:** описание задачи на бизнес- и техническом языке, список заинтересованных сторон, понимание пользы модели для реального бизнеса.

---

#### **Фаза 2. Data Understanding (1–2 недели)**
- Генерация и загрузка **синтетических данных**, приближенных к реальным параметрам объектов и узлов компрессорной станции.
- Статистический анализ: распределения, типы данных, выявление выбросов и пропусков.
- Проверка на логичность: соответствие значениям давления, ppm, возраста элементов оборудования и т.д.
- Визуализация: профайлинг, гистограммы, scatter-графики, boxplot'ы.
- Построение корреляционных матриц (Пирсон, Спирмен) для оценки значимости признаков.

**Результат:** понимание структуры и качества данных, описание гипотез, формулировка ожиданий от модели. Предварительный отбор полезных признаков.

---

#### **Фаза 3. Data Preparation (1–2 недели)**
- Отбор признаков: удаление служебных, неинформативных или утечек данных.
- Очистка: удаление или заполнение пропусков, устранение аномалий.
- Feature engineering: расчет возраста оборудования, интервалов с последнего ТО, нормализация ppm и др.
- Кодирование категориальных признаков (например, материал, тип уплотнения).
- Создание целевой переменной `leak_within_30d` (на синтетике — по заранее заданной логике, на реальных данных — по истории аварий и замеров).
- Разделение данных на обучающую, валидационную и тестовую выборки.

**Результат:** финальная таблица (flat table), готовая к обучению, и базовый пайплайн предобработки.

---

#### **Фаза 4. Modeling (2–3 недели)**
- Выбор моделей: LightGBM как основная, Logistic Regression и Random Forest как baseline, опционально CatBoost.
- Подбор гиперпараметров (Grid Search, Optuna).
- Оценка моделей по метрикам: AUC-ROC, Precision@TopN, Logloss.
- Интерпретация модели: важность признаков (feature importance).
- Анализ ошибок и кейсов: почему утечка не предсказана, где переобучение.
- Возможный тест временных моделей (LSTM/TCN) для замеров во времени.

**Результат:** обученная модель с интерпретацией, отчет о метриках, ранжирование признаков по важности.

---

#### **Фаза 5. Evaluation (1 неделя)**
- Сравнение качества моделей и выбор финальной.
- Проверка соответствия бизнес-целям: интерпретируемость, предсказуемость, доверие.
- Тестирование на инженерных сценариях: модель предсказала утечку — есть ли подтверждение в данных?
- Проверка на переобучение, логичность модели (например, старое оборудование действительно выше риск?).
- Подготовка выводов и презентации результатов.

**Результат:** подтверждение готовности модели к демонстрации, внутреннее согласование, пакет с результатами и интерпретацией.

---

#### **Фаза 6. Deployment (1 неделя)**
- Разработка простого дашборда (на Streamlit или др.), отображающего риск по узлам.
- Формирование API/скрипта для применения модели к новым данным.
- Имитация «живого» использования: как оператор будет видеть алерты.
- Документация по модели и пайплайну.

**Результат:** MVP-решение: дашборд + модель + описание, готовое для демонстрации заказчику.

---

#### Общий срок реализации проекта — **2 месяца**.


Пример датасета:
| equipment_id | timestamp   | equipment_age_days | last_maintenance_days_ago | corrosion_detected | material   | pressure_rating | methane_ppm_last | wind_speed | ambient_temperature | operating_pressure | flow_rate | temperature | leak_within_30d |
|--------------|-------------|---------------------|----------------------------|---------------------|------------|------------------|-------------------|-------------|----------------------|---------------------|------------|-------------|------------------|
| FL_301       | 2025-03-01  | 2512                | 367                        | 0                   | нержавейка | PN40             | 2.66              | 2.81        | -5.3                 | 36.93               | 14077      | 16.9        | 0                |
| FL_301       | 2025-03-04  | 2515                | 882                        | 1                   | нержавейка | PN63             | 1.99              | 3.83        | 14.3                 | 49.71               | 15250      | 17.2        | 0                |
| FL_301       | 2025-03-07  | 2518                | 319                        | 1                   | нержавейка | PN40             | 27.96             | 4.24        | 1.7                  | 42.82               | 13027      | 12.0        | 0                |
| FL_301       | 2025-03-10  | 2521                | 192                        | 0                   | сталь      | PN40             | 18.43             | 3.99        | 2.4                  | 36.45               | 11736      | 11.7        | 0                |
| FL_301       | 2025-03-13  | 2524                | 1134                       | 0                   | нержавейка | PN25             | 2.05              | 2.90        | 5.9                  | 47.76               | 11326      | 11.2        | 0                |
| FL_301       | 2025-03-16  | 2527                | 1037                       | 1                   | нержавейка | PN25             | 12.73             | 4.57        | 14.9                 | 40.46               | 10121      | 22.6        | 0                |
| FL_301       | 2025-03-19  | 2530                | 881                        | 0                   | нержавейка | PN63             | 52.01             | 5.74        | -13.7                | 41.60               | 10102      | 18.4        | 1                |
| FL_301       | 2025-03-22  | 2533                | 345                        | 0                   | нержавейка | PN63             | 8.58              | 3.88        | 9.3                  | 40.87               | 11784      | 18.7        | 0                |
| FL_301       | 2025-03-25  | 2536                | 1180                       | 0                   | нержавейка | PN25             | 30.09             | 2.78        | -12.0                | 47.54               | 9230       | 11.9        | 0                |
| FL_301       | 2025-03-28  | 2539                | 696                        | 0                   | нержавейка | PN63             | 11.33             | 4.63        | -0.9                 | 38.51               | 9459       | 9.8         | 0                |
